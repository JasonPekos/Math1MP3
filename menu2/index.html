<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/Math1MP3/libs/katex/katex.min.css"> <link rel=stylesheet  href="/Math1MP3/libs/highlight/github.min.css"> <link rel=stylesheet  href="/Math1MP3/css/franklin.css"> <link rel=stylesheet  href="/Math1MP3/css/basic.css"> <!-- <link rel=icon  href="/Math1MP3/assets/favicon.png">--> <title>Solutions</title> <header> <div class=blog-name ><a href="/Math1MP3/">Math 1MP3 — Labs</a></div> <nav> <ul> <li><a href="/Math1MP3/">Home</a> <li><a href="/Math1MP3/menu1/">Lab Recordings</a> <li><a href="/Math1MP3/menu2/">Solutions</a> <li><a href="/Math1MP3/menu3/">Misc</a> </ul> <img src="/Math1MP3/assets/hamburger.svg" id=menu-icon > </nav> </header> <div class=franklin-content ><div class=franklin-toc ><ol><li><a href="#lab_two">Lab Two</a><ol><li><a href="#problem_9">Problem 9</a><li><a href="#problem_10">Problem 10</a><li><a href="#problem_11">Problem 11</a><li><a href="#problem_12">Problem 12</a><li><a href="#problem_13">Problem 13</a><li><a href="#problem_14">Problem 14</a><li><a href="#problem_15">Problem 15</a><li><a href="#problem_16">Problem 16</a><li><a href="#problem_17">Problem 17</a><li><a href="#problem_18">Problem 18</a><li><a href="#problem_19">Problem 19</a><li><a href="#problem_20">Problem 20</a><li><a href="#problem_21">Problem 21</a><li><a href="#problem_22">Problem 22</a><li><a href="#problem_23">Problem 23</a><li><a href="#problem_24">Problem 24</a><li><a href="#problem_25">Problem 25</a><li><a href="#problem_26">Problem 26</a><li><a href="#problem_27">Problem 27</a><li><a href="#problem_28">Problem 28</a><li><a href="#problem_29">Problem 29</a></ol><li><a href="#post_test-one">Post Test-One</a><ol><li><a href="#problem_58_68">Problem 58, 68</a><li><a href="#problem_59">Problem 59</a><li><a href="#problem_60">Problem 60</a><li><a href="#problem_61">Problem 61</a></ol></ol></div> <h2 id=lab_two ><a href="#lab_two" class=header-anchor >Lab Two</a></h2> <p>Some of the solutions here are difficult to understand. If you want to understand them, you should come to tutorial&#33; This list is not a substitute for tutorial &#40;or office hours&#41;.</p> <h3 id=problem_9 ><a href="#problem_9" class=header-anchor >Problem 9</a></h3> <p><strong>Q:</strong> If <code>Alist&#61;&#91;9,-4,33,2,89,100,36,11&#93;</code>, what is <code>Alist&#91;2&#93;</code>? What is <code>Alist&#91;2&#93;&#91;1&#93;</code>?</p> <p><strong>A:</strong> Test it out and see for yourself&#33; Email any questions and I&#39;ll be happy to answer.</p> <hr /> <h3 id=problem_10 ><a href="#problem_10" class=header-anchor >Problem 10</a></h3> <p><strong>Q:</strong> In the cases provided in the problem set, predict the behavior of the code, and check for yourself.</p> <p><strong>A:</strong> Covered in-depth during lecture; solution not provided.</p> <hr /> <h3 id=problem_11 ><a href="#problem_11" class=header-anchor >Problem 11</a></h3> <p>Write a code to find </p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mn>10</mn><mo separator=true >,</mo><mn>000</mn></mrow></munderover><mfrac><mn>1</mn><mi>j</mi></mfrac></mrow><annotation encoding="application/x-tex">\sum_{j=1}^{10,000} \frac{1}{j}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3.261998em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8482210000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.347113em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span><span class="mpunct mtight">,</span><span class="mord mtight">000</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <pre><code class="python hljs">val = <span class=hljs-number >0</span>
<span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >10_001</span>):
    val += <span class=hljs-number >1</span>/j

val</code></pre> <p>or</p> <pre><code class="python hljs"><span class=hljs-built_in >sum</span>(<span class=hljs-number >1</span>/i <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >10_001</span>))</code></pre>
<hr />
<h3 id=problem_12 ><a href="#problem_12" class=header-anchor >Problem 12</a></h3>
<p>Write code to find </p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mn>600</mn></munderover><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>10</mn></mrow><mn>450</mn></munderover><mfrac><mi>m</mi><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">\sum_{m=1}^{600} \sum_{n=10}^{450} \frac{m}{n}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3.068226em;vertical-align:-1.267113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8011130000000004em;"><span style="top:-1.882887em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">600</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.267113em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8011130000000004em;"><span style="top:-1.882887em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">10</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">450</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.267113em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.10756em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<pre><code class="python hljs">val = <span class=hljs-number >0</span> 
<span class=hljs-keyword >for</span> m <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>, <span class=hljs-number >601</span>):
    <span class=hljs-keyword >for</span> n <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >10</span>, <span class=hljs-number >451</span>):
        val += m/n

val</code></pre>
<hr />
<h3 id=problem_13 ><a href="#problem_13" class=header-anchor >Problem 13</a></h3>
<p>Find the sum of all positive integers from 1 to 1000 which are not divisible by 4 or 5</p>
<pre><code class="python hljs"><span class=hljs-built_in >sum</span>([i <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >1000</span>) <span class=hljs-keyword >if</span> i % <span class=hljs-number >4</span> != <span class=hljs-number >0</span> <span class=hljs-keyword >and</span> i % <span class=hljs-number >5</span> != <span class=hljs-number >0</span>])</code></pre>
<hr />
<h3 id=problem_14 ><a href="#problem_14" class=header-anchor >Problem 14</a></h3>
<p>Create a list of squares of all numbers <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span>, where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>x</mi><mo>≤</mo><mn>20</mn><mo separator=true >,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">1 \leq x \leq 20,000</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >20</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >000</span></span></span></span>, and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> is divisible by <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7</mn></mrow><annotation encoding="application/x-tex">7</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >7</span></span></span></span>.</p>
<pre><code class="python hljs">sList = []

<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >20_001</span>):
    <span class=hljs-keyword >if</span> i % <span class=hljs-number >7</span> == <span class=hljs-number >0</span>:
        sList.append(i**<span class=hljs-number >2</span>)

sList</code></pre>
<p>or</p>
<pre><code class="python hljs">[x**<span class=hljs-number >2</span> <span class=hljs-keyword >for</span> x <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >20_001</span>) <span class=hljs-keyword >if</span> x % <span class=hljs-number >7</span> == <span class=hljs-number >0</span>]</code></pre>
<hr />
<h3 id=problem_15 ><a href="#problem_15" class=header-anchor >Problem 15</a></h3>
<p>From a list of squares of numbers <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span>, where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>x</mi><mo>≤</mo><mn>100</mn><mo separator=true >,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">1 \leq x \leq 100,000</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >100</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >000</span></span></span></span>, remove all entries which start with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9</mn></mrow><annotation encoding="application/x-tex">9</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >9</span></span></span></span> and end with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> or <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>.</p>
<pre><code class="python hljs">sList = []

<span class=hljs-keyword >for</span> x <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >100_001</span>):
    <span class=hljs-keyword >if</span>(<span class=hljs-built_in >str</span>(x**<span class=hljs-number >2</span>)[<span class=hljs-number >0</span>] == <span class=hljs-string >&quot;9&quot;</span>):
        <span class=hljs-keyword >if</span>(<span class=hljs-built_in >str</span>(x**<span class=hljs-number >2</span>)[-<span class=hljs-number >1</span>] == <span class=hljs-string >&quot;0&quot;</span> <span class=hljs-keyword >or</span> <span class=hljs-built_in >str</span>(x**<span class=hljs-number >2</span>)[-<span class=hljs-number >1</span>] == <span class=hljs-string >&quot;1&quot;</span>):
            <span class=hljs-keyword >pass</span>
        <span class=hljs-keyword >else</span>:
            sList.append(x**<span class=hljs-number >2</span>)
    <span class=hljs-keyword >else</span>:
        sList.append(x**<span class=hljs-number >2</span>)

sList</code></pre>
<p>or</p>
<pre><code class="python hljs">[x**<span class=hljs-number >2</span> <span class=hljs-keyword >for</span> x <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >101</span>) <span class=hljs-keyword >if</span> ((<span class=hljs-built_in >str</span>(x**<span class=hljs-number >2</span>)[<span class=hljs-number >0</span>] != <span class=hljs-string >&quot;9&quot;</span>) <span class=hljs-keyword >and</span> (<span class=hljs-built_in >str</span>(x**<span class=hljs-number >2</span>)[-<span class=hljs-number >1</span>] != <span class=hljs-string >&quot;0&quot;</span>) <span class=hljs-keyword >or</span> (<span class=hljs-built_in >str</span>(x**<span class=hljs-number >2</span>)[-<span class=hljs-number >1</span>] != <span class=hljs-string >&quot;1&quot;</span>))]</code></pre>
<hr />
<h3 id=problem_16 ><a href="#problem_16" class=header-anchor >Problem 16</a></h3>
<p>Write a code to determine whether a given year is a leap year or not. Input: a year between <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1600</mn></mrow><annotation encoding="application/x-tex">1600</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1600</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2200</mn></mrow><annotation encoding="application/x-tex">2200</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2200</span></span></span></span>. Output: Year <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1997</mn></mrow><annotation encoding="application/x-tex">1997</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1997</span></span></span></span> is not a leap year. Year <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2004</mn></mrow><annotation encoding="application/x-tex">2004</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2004</span></span></span></span> is a leap year. etc.</p>
<p>note: years divisible by 4 are leap years, except if they are divisible by 100 but not divisible by 400. Thus, 1700, 1800, 1900, 2100 are not leap years, but 2000, 2400 are leap years.</p>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">IsLeapYear</span>(<span class=hljs-params >year: <span class=hljs-built_in >int</span></span>) -&gt; <span class=hljs-built_in >bool</span>:
    <span class=hljs-keyword >return</span>(year <span class=hljs-keyword >in</span> [year <span class=hljs-keyword >for</span> year <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1600</span>, <span class=hljs-number >2500</span>) <span class=hljs-keyword >if</span> ((year % <span class=hljs-number >4</span> == <span class=hljs-number >0</span>) <span class=hljs-keyword >and</span> <span class=hljs-keyword >not</span> (year % <span class=hljs-number >100</span> == <span class=hljs-number >0</span> <span class=hljs-keyword >and</span> year % <span class=hljs-number >400</span> != <span class=hljs-number >0</span>))])</code></pre>
<hr />
<h3 id=problem_17 ><a href="#problem_17" class=header-anchor >Problem 17</a></h3>
<p>Find the sum of all digits used in writing down the numbers from 1 to 2 million &#40;including 1 and including 2 million&#41;.</p>
<pre><code class="python hljs"><span class=hljs-built_in >sum</span>([<span class=hljs-built_in >sum</span>(<span class=hljs-built_in >map</span>(<span class=hljs-built_in >int</span>,<span class=hljs-built_in >str</span>(x))) <span class=hljs-keyword >for</span> x <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >2_000_001</span>)])</code></pre>
<hr />
<h3 id=problem_18 ><a href="#problem_18" class=header-anchor >Problem 18</a></h3>
<p>Write a Python code which computes the sum</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>S</mi><mo>=</mo><munderover><mo>∑</mo><mrow><msup><mi>i</mi><mo lspace=0em  rspace=0em >∗</mo></msup><mo>=</mo><mn>1</mn></mrow><mn>10000</mn></munderover><mfrac><mn>1</mn><msup><mi>i</mi><mo lspace=0em  rspace=0em >∗</mo></msup></mfrac></mrow><annotation encoding="application/x-tex">S=\sum_{i^{*}=1}^{10000} \frac{1}{i^{*}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:3.0787820000000004em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8011130000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6183428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10000</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">i</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6146959999999999em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>i</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">i^*</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.688696em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">i</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> is a number written without the number seven, e.g.</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>S</mi><mo>=</mo><mfrac><mn>1</mn><mn>1</mn></mfrac><mo>+</mo><mo>⋯</mo><mo>+</mo><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>8</mn></mfrac><mo>+</mo><mo>⋯</mo><mo>+</mo><mfrac><mn>1</mn><mn>16</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>18</mn></mfrac><mo>+</mo><mo>⋯</mo><mo>+</mo><mfrac><mn>1</mn><mn>69</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>80</mn></mfrac><mo>+</mo><mo>⋯</mo><mo>+</mo><mfrac><mn>1</mn><mn>10000</mn></mfrac></mrow><annotation encoding="application/x-tex">S=\frac{1}{1}+\cdots+\frac{1}{6}+\frac{1}{8}+\cdots+\frac{1}{16}+\frac{1}{18}+\cdots+\frac{1}{69}+\frac{1}{80}+\cdots+\frac{1}{10000}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >6</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >8</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >16</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >18</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >69</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >80</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >10000</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<pre><code class="python hljs"><span class=hljs-built_in >sum</span>([<span class=hljs-built_in >int</span> <span class=hljs-keyword >for</span> <span class=hljs-built_in >int</span> <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >10001</span>) <span class=hljs-keyword >if</span> <span class=hljs-string >&quot;7&quot;</span> <span class=hljs-keyword >not</span> <span class=hljs-keyword >in</span> <span class=hljs-built_in >str</span>(<span class=hljs-built_in >int</span>)])</code></pre>
<hr />
<h3 id=problem_19 ><a href="#problem_19" class=header-anchor >Problem 19</a></h3>
<p>You are speeding on a highway and a police officer stops you. Write a code to compute the fine that you might have to pay &#40;call the variable fine&#41;, based on the following rules &#40;assume that the speed is a positive integer&#41;:</p>
<ul>
<li><p>If your speed is 110 km/h or less, the fine is zero.</p>

<li><p>If your speed is between 111 and 130 inclusive, the fine is 150.</p>

<li><p>If your speed is above 130 km/h, the fine is 350.</p>

<li><p>If it is your birthday, your speed can be 5 km/h higher in all cases &#40;use your actual birthday, or make one up&#41;</p>

<li><p>For instance, if you drive 114 km/h on your birthday, your fine is zero.</p>

</ul>
<p>If you drive 118 km/h on your birthday, your fine &#36;150. If you drive 114 km/h and it’s not your birthday, your fine is &#36;150.</p>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">FineValue</span>(<span class=hljs-params >speed: <span class=hljs-built_in >int</span>, isBirthday: <span class=hljs-built_in >bool</span></span>) -&gt; <span class=hljs-built_in >int</span>:

    fine = <span class=hljs-number >0</span>

    <span class=hljs-keyword >if</span>(isBirthday == <span class=hljs-number >1</span>):
        speed -= <span class=hljs-number >5</span>

    <span class=hljs-keyword >if</span>(<span class=hljs-number >111</span> &lt;= speed &lt;= <span class=hljs-number >130</span>):
        fine = <span class=hljs-number >150</span>

    <span class=hljs-keyword >if</span>( <span class=hljs-number >130</span>&lt; speed):
        fine = <span class=hljs-number >350</span>

    <span class=hljs-keyword >return</span> fine</code></pre>
<hr />
<h3 id=problem_20 ><a href="#problem_20" class=header-anchor >Problem 20</a></h3>
<p>Let <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>123456...99979998999910000</mn></mrow><annotation encoding="application/x-tex">M = 123456 ... 99979998999910000</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >123456...99979998999910000</span></span></span></span> &#40;i.e., M is obtained by writing all numbers from <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10000</mn></mrow><annotation encoding="application/x-tex">10000</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >10000</span></span></span></span> next to each other&#41;</p>
<ul>
<li><p>How many digits does <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> have?</p>

<li><p>How many times does the number <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7</mn></mrow><annotation encoding="application/x-tex">7</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >7</span></span></span></span> appear in <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>?</p>

</ul>
<pre><code class="python hljs">digits = <span class=hljs-number >0</span>
sevens = <span class=hljs-number >0</span>
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>, <span class=hljs-number >10_001</span>):
    <span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-built_in >str</span>(i):
        digits += <span class=hljs-number >1</span>
        <span class=hljs-keyword >if</span> j == <span class=hljs-string >&quot;7&quot;</span>:
            sevens += <span class=hljs-number >1</span>

<span class=hljs-built_in >print</span>(digits)
<span class=hljs-built_in >print</span>(sevens)</code></pre>
<h3 id=problem_21 ><a href="#problem_21" class=header-anchor >Problem 21</a></h3>
<p><em>Problem Twenty One</em></p>
<p>Let <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>124567891011121415...282940414244...999799989999</mn></mrow><annotation encoding="application/x-tex">N = 124567891011121415 ...282940414244 ...999799989999</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >124567891011121415...282940414244...999799989999</span></span></span></span> &#40;i.e., N is obtained by writing all numbers from 1 to 9999 that do not contain digit 3&#41;</p>
<ul>
<li><p>How many digits does N have?</p>

<li><p>Is <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> divisible by three?</p>

</ul>
<pre><code class="python hljs">N = <span class=hljs-string >&quot;&quot;</span>
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >10_000</span>):
    N += <span class=hljs-built_in >str</span>(i)

<span class=hljs-built_in >len</span>(N)
<span class=hljs-built_in >int</span>(N) % <span class=hljs-number >3</span></code></pre>
<hr />
<h3 id=problem_22 ><a href="#problem_22" class=header-anchor >Problem 22</a></h3>
<p>Create a list with the following pattern:</p>
<p>write natural numbers in a sequence and remove all numbers which are either divisible by 3 or contain the digit 3. Find the 10,000th number in this list</p>
<p>and find the 10&#39;000th element in this list</p>
<pre><code class="python hljs">aList = []
val = <span class=hljs-number >0</span>

<span class=hljs-keyword >while</span> (<span class=hljs-built_in >len</span>(aList) &lt;= <span class=hljs-number >10_001</span>):
    val += <span class=hljs-number >1</span>
    <span class=hljs-keyword >if</span>(val % <span class=hljs-number >3</span> != <span class=hljs-number >0</span>  <span class=hljs-keyword >and</span> <span class=hljs-string >&quot;3&quot;</span> <span class=hljs-keyword >not</span> <span class=hljs-keyword >in</span> <span class=hljs-built_in >str</span>(val)):
        aList.append(val)

aList[<span class=hljs-number >10_001</span>]</code></pre>
<hr />
<h3 id=problem_23 ><a href="#problem_23" class=header-anchor >Problem 23</a></h3>
<p><em>Problem Twenty Three</em></p>
<p>Write a code that computes the transpose of some matrix M, of the form:</p>
<code>M&#61;&#91;&#91;1,2,3&#93;,&#91;4,5,6&#93;,&#91;7,8,9&#93;&#93;</code>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> typing <span class=hljs-keyword >import</span> <span class=hljs-type >List</span>

<span class=hljs-keyword >def</span> <span class="hljs-title function_">Transpose</span>(<span class=hljs-params >M:<span class=hljs-type >List</span>[<span class=hljs-type >List</span>]</span>) -&gt; <span class=hljs-type >List</span>[<span class=hljs-type >List</span>]:
    <span class=hljs-string >&quot;&quot;&quot;This transposes a matrix :D&quot;&quot;&quot;</span>
    <span class=hljs-keyword >return</span>([[row[i] <span class=hljs-keyword >for</span> row <span class=hljs-keyword >in</span> M] <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-built_in >len</span>(M[<span class=hljs-number >0</span>]))])</code></pre>
<hr />
<h3 id=problem_24 ><a href="#problem_24" class=header-anchor >Problem 24</a></h3>
<p>Given a non-empty list of numbers &#40;call in num&#41;, write a code to find the largest and the smallest numbers in num. Then compare with the built-in functions max&#40;num&#41; and min&#40;num&#41;.</p>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> typing <span class=hljs-keyword >import</span> <span class=hljs-type >List</span>, <span class=hljs-type >Union</span>
<span class=hljs-keyword >import</span> math

<span class=hljs-keyword >def</span> <span class="hljs-title function_">BruteMin</span>(<span class=hljs-params >num: <span class=hljs-type >List</span>[<span class=hljs-type >Union</span>[<span class=hljs-built_in >int</span>, <span class=hljs-built_in >float</span>]]</span>) -&gt; <span class=hljs-type >Union</span>[<span class=hljs-built_in >int</span>, <span class=hljs-built_in >float</span>]:
    <span class=hljs-string >&quot;&quot;&quot;Returns the smallest number from a list of numbers&quot;&quot;&quot;</span>
    <span class=hljs-built_in >min</span> = math.inf
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> num:
        <span class=hljs-keyword >if</span>(i &lt; <span class=hljs-built_in >min</span>):
            <span class=hljs-built_in >min</span> = i
    
    <span class=hljs-keyword >return</span> <span class=hljs-built_in >min</span> 


<span class=hljs-keyword >def</span> <span class="hljs-title function_">BruteMax</span>(<span class=hljs-params >num: <span class=hljs-type >List</span>[<span class=hljs-type >Union</span>[<span class=hljs-built_in >int</span>, <span class=hljs-built_in >float</span>]]</span>) -&gt; <span class=hljs-type >Union</span>[<span class=hljs-built_in >int</span>, <span class=hljs-built_in >float</span>]:
    <span class=hljs-string >&quot;&quot;&quot;Returns the largest number from a list of numbers&quot;&quot;&quot;</span>
    <span class=hljs-built_in >max</span> = -math.inf
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> num:
        <span class=hljs-keyword >if</span>(i &gt; <span class=hljs-built_in >max</span>):
            <span class=hljs-built_in >max</span> = i
    
    <span class=hljs-keyword >return</span> <span class=hljs-built_in >max</span></code></pre>
<hr />
<h3 id=problem_25 ><a href="#problem_25" class=header-anchor >Problem 25</a></h3>
<p>Define the function is prime&#40;p&#41; which returns True if <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> is a prime number and False otherwise. You can assume that <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> is an integer, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p \geq 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>.</p>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">IsPrime</span>(<span class=hljs-params >p:<span class=hljs-built_in >float</span></span>) -&gt; <span class=hljs-built_in >bool</span>:
    <span class=hljs-string >&quot;&quot;&quot;Checks if a number is prime!&quot;&quot;&quot;</span>
    <span class=hljs-keyword >if</span> p == <span class=hljs-number >1</span>: <span class=hljs-keyword >return</span> <span class=hljs-literal >False</span>
    <span class=hljs-keyword >return</span> <span class=hljs-built_in >all</span>([p % i <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >2</span>,p)])</code></pre>
<hr />
<h3 id=problem_26 ><a href="#problem_26" class=header-anchor >Problem 26</a></h3>
<p>Define the function all divisors&#40;n&#41;, where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n &gt; 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>, which stores all divisors of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> &#40;including <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>&#41; into a list.</p>
<pre><code class="python hljs"><span class=hljs-keyword >from</span> typing <span class=hljs-keyword >import</span> <span class=hljs-type >List</span>

<span class=hljs-keyword >def</span> <span class="hljs-title function_">nDivisors</span>(<span class=hljs-params >n:<span class=hljs-built_in >int</span></span>) -&gt; <span class=hljs-type >List</span>[<span class=hljs-built_in >int</span>]:
    <span class=hljs-string >&quot;&quot;&quot;Returns all divisors of integer n&quot;&quot;&quot;</span>
    <span class=hljs-keyword >return</span> [j <span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>, n+<span class=hljs-number >1</span>) <span class=hljs-keyword >if</span> n % j == <span class=hljs-number >0</span>]</code></pre>
<hr />
<h3 id=problem_27 ><a href="#problem_27" class=header-anchor >Problem 27</a></h3>
<p>Print “I love math” once, then “I hate math” once; then “I love math” two times, then “I hate math” once; then “I love math” three times, then “I hate math” once; then “I love math” four times, then “I hate math” once, and so on, until a total of 100 lines are printed.</p>
<pre><code class="python hljs">val = <span class=hljs-number >0</span>
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >101</span>):
    <span class=hljs-keyword >if</span> i % <span class=hljs-number >2</span> != <span class=hljs-number >0</span>:
        val += <span class=hljs-number >1</span>
        <span class=hljs-built_in >print</span>(val*<span class=hljs-string >&quot;I love math &quot;</span>)
    <span class=hljs-keyword >else</span>:
        <span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;I hate math&quot;</span>)</code></pre>
<hr />
<h3 id=problem_28 ><a href="#problem_28" class=header-anchor >Problem 28</a></h3>
<p>Create a list <code>A</code> so that <code>A&#91;i&#93; &#61; sum of digits of i</code>, for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mn>10000</mn></mrow><annotation encoding="application/x-tex">0 \leq i \leq 10000</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.79549em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >10000</span></span></span></span>, i.e.,</p>
<code>A &#61; &#91;0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 1, 2, 3, 4,..., 1&#93;</code>
<pre><code class="python hljs">A = [<span class=hljs-built_in >sum</span>(<span class=hljs-built_in >map</span>(<span class=hljs-built_in >int</span>, <span class=hljs-built_in >str</span>(i))) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >1</span>,<span class=hljs-number >10_000</span>)]</code></pre>
<hr />
<h3 id=problem_29 ><a href="#problem_29" class=header-anchor >Problem 29</a></h3>
<p>Create a list of the first 100 prime numbers.</p>
<pre><code class="python hljs">primes = []
counter = <span class=hljs-number >1</span>
<span class=hljs-keyword >while</span> <span class=hljs-built_in >len</span>(primes) &lt; <span class=hljs-number >100</span>:
    <span class=hljs-comment ># Using problem 25 function `IsPrime`</span>
    <span class=hljs-keyword >if</span>(IsPrime(counter) == <span class=hljs-number >1</span>):
        primes.append(counter)
    counter += <span class=hljs-number >1</span></code></pre>
<h2><hr /></h2>
<h2 id=post_test-one ><a href="#post_test-one" class=header-anchor >Post Test-One</a></h2>
<p>At the request of some students, here are some later problems. The numbering scheme changes across the versions of the problem sets, so in this case, I am using the <em>28 February - 4 March</em> problem set.</p>
<p>Some solutions contain graphs, or programming concepts that you may not have covered in lecture &#40;e.g. comprehensions&#41; –- though I&#39;m trying to avoid the later one for these solutions –- so don&#39;t worry about this if you haven&#39;t seen it before. The graphs especially are simply a nice way to view the solution. Don&#39;t worry about it.</p>
<hr />
<h3 id=problem_58_68 ><a href="#problem_58_68" class=header-anchor >Problem 58, 68</a></h3>
<p>Write a function <code>Newton&#40;f,fprime,x0,tol,max steps&#41;</code> which produces a list of approximations &#40;starting with <code>x0</code>&#41; of a solution to <code>f&#40;x&#41; &#61; 0</code> using Newton’s method. Stop the process when either the number of steps reaches max steps or the value of f is less than tol. Recall that Newton’s method gives a sequence of approximations:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mfrac><mrow><mi>f</mi><mrow><mo fence=true >(</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence=true >)</mo></mrow></mrow><mrow><msup><mi>f</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup><mrow><mo fence=true >(</mo><msub><mi>x</mi><mi>n</mi></msub><mo fence=true >)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">x_{n+1}=x_{n}-\frac{f\left(x_{n}\right)}{f^{\prime}\left(x_{n}\right)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.638891em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.73333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.363em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6778919999999999em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>which, for a differentiable function, approximate a solution <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x) = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> &#40;if <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is close to it&#41;.</p>
<p>Test your function on <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mo>−</mo><mn>1</mn><mo separator=true >,</mo><mn>3</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[-1,3]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >−</span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >3</span><span class=mclose >]</span></span></span></span> by solving:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>2</mn><mi>x</mi><mo>+</mo><mn>3</mn><mi>sin</mi><mo>⁡</mo><mo stretchy=false >(</mo><mn>2</mn><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x)=x^{3}-x^{2}-2 x+3 \sin (2 x)=0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >2</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >3</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop >sin</span><span class=mopen >(</span><span class=mord >2</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span></span>
<p><strong>Soln:</strong> first, we write the functions for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mo mathvariant=normal >′</mo></msup></mrow><annotation encoding="application/x-tex">f^\prime</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.946332em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span>.</p>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">f</span>(<span class=hljs-params >x: <span class=hljs-built_in >complex</span></span>) -&gt; <span class=hljs-built_in >complex</span>:
    <span class=hljs-keyword >return</span> x**<span class=hljs-number >3</span> - x**<span class=hljs-number >2</span> - <span class=hljs-number >2</span>*x + <span class=hljs-number >3</span>*np.sin(<span class=hljs-number >2</span>*x)

<span class=hljs-keyword >def</span> <span class="hljs-title function_">fPrime</span>(<span class=hljs-params >x: <span class=hljs-built_in >complex</span></span>) -&gt; <span class=hljs-built_in >complex</span>:
    <span class=hljs-keyword >return</span> <span class=hljs-number >3</span>*x**<span class=hljs-number >2</span> -<span class=hljs-number >2</span>*x +<span class=hljs-number >6</span>*np.cos(<span class=hljs-number >2</span>*x - <span class=hljs-number >2</span>)</code></pre>
<p>The question asks for these both, and so the assumption is that it wants an analytic solution to the derivative. We will also extend the question, and explore the case where the derivative is not computed analytically, and so not required as a function argument. The solution for Newton&#39;s method follows:</p>
<pre><code class="python hljs"><span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np
<span class=hljs-keyword >import</span> math

<span class=hljs-keyword >def</span> <span class="hljs-title function_">Newton</span>(<span class=hljs-params >function, derivative, x0:<span class=hljs-built_in >float</span>, tol:<span class=hljs-built_in >float</span>, max_steps:<span class=hljs-built_in >int</span></span>) -&gt; <span class=hljs-built_in >float</span>:
    <span class=hljs-string >&quot;&quot;&quot;A simple Newton&#x27;s method solution to a function with a known derivative.&quot;&quot;&quot;</span>
    ratio = math.inf
    x = x0
    steps = <span class=hljs-number >0</span>

    <span class=hljs-keyword >while</span>(<span class=hljs-built_in >abs</span>(f(x)) &gt; tol):
        ratio  = function(x)/derivative(x)
        x = x - ratio

        <span class=hljs-keyword >if</span> steps &gt; max_steps:
            <span class=hljs-keyword >break</span>

    <span class=hljs-keyword >return</span>(x)</code></pre>
<p>We would like to extend this into the case where the derivative <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span> is not know a priori &#40;it isn&#39;t in most real life scenarios&#41;. To do this, we write a function to compute the derivative <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span> of some given input <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">F(x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span>. This is a separate problem in the worksheet &#40;<strong>68</strong>&#41;, but we solve it here instead. To find the derivative, we go back to calculus one, and use the difference quotient:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mrow><mi>F</mi><mo stretchy=false >(</mo><mi>x</mi><mo>+</mo><mi>h</mi><mo stretchy=false >)</mo><mo>−</mo><mi>F</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><mi>h</mi></mfrac></mrow><annotation encoding="application/x-tex">f(x) = \frac{F(x + h) - F(x)}{h}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.113em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">h</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">Diff</span>(<span class=hljs-params >f, x, h = <span class=hljs-number >0.001</span></span>) -&gt; <span class=hljs-built_in >float</span>:
    <span class=hljs-string >&quot;&quot;&quot;This gives us a crude approximation to the first derivative of f&quot;&quot;&quot;</span>
    <span class=hljs-keyword >return</span> (f(x + h) - f(x))/h</code></pre>
<p>We can rewrite Newton&#39;s method using this as:</p>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">Newton</span>(<span class=hljs-params >function, x0:<span class=hljs-built_in >float</span>, tol:<span class=hljs-built_in >float</span>, max_steps:<span class=hljs-built_in >int</span></span>) -&gt; <span class=hljs-built_in >float</span>:
    <span class=hljs-string >&quot;&quot;&quot;A simple Newton&#x27;s method solution to a function with an unknown derivative.&quot;&quot;&quot;</span>
    ratio = math.inf
    x = x0
    steps = <span class=hljs-number >0</span>

    <span class=hljs-keyword >while</span>(<span class=hljs-built_in >abs</span>(f(x)) &gt; tol):
        ratio  = function(x)/Diff(f,x)
        x = x - ratio

        <span class=hljs-keyword >if</span> steps &gt; max_steps:
            <span class=hljs-keyword >break</span>

    <span class=hljs-keyword >return</span>(x)</code></pre>
<p>Now, this is a decent approximation, but it fails in some major respects &#40;if you want to know more, take a numerical analysis course&#33;&#41;. We can construct a much more clever approximation to the derivative using a simple Taylor series trick. &#40;you can ignore this if you want; it won&#39;t show up on your test. it is very cool though.&#41;</p>
<p>Given some function <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>:</mo><mi mathvariant=double-struck >R</mi><mo>→</mo><mi mathvariant=double-struck >R</mi></mrow><annotation encoding="application/x-tex">f: \mathbb{R} \to \mathbb{R}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">R</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >→</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">R</span></span></span></span>, we can construct the taylor series with:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=normal >∞</mi></munderover><mfrac><mrow><msup><mi>f</mi><mrow><mo stretchy=false >(</mo><mi>n</mi><mo stretchy=false >)</mo></mrow></msup><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo></mrow><mrow><mi>n</mi><mo stretchy=false >!</mo></mrow></mfrac><mo stretchy=false >(</mo><mi>x</mi><mo>−</mo><mi>a</mi><msup><mo stretchy=false >)</mo><mi>n</mi></msup><mo>=</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo><mo>+</mo><msup><mi>f</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo><mo stretchy=false >(</mo><mi>x</mi><mo>−</mo><mi>a</mi><mo stretchy=false >)</mo><mo>+</mo><mfrac><mrow><msup><mi>f</mi><mrow><mo mathvariant=normal >′</mo><mo mathvariant=normal >′</mo></mrow></msup><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo></mrow><mrow><mn>2</mn><mo stretchy=false >!</mo></mrow></mfrac><mo stretchy=false >(</mo><mi>x</mi><mo>−</mo><mi>a</mi><msup><mo stretchy=false >)</mo><mn>2</mn></msup><mo>+</mo><mo>…</mo><mo stretchy=false >(</mo><mtext>error</mtext><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(x)=\sum_{n=0}^{\infty} \frac{f^{(n)}(a)}{n !}(x-a)^{n}=f(a)+f^{\prime}(a)(x-a)+\frac{f^{\prime \prime}(a)}{2 !}(x-a)^{2}+\ldots (\text{error})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.9185100000000004em;vertical-align:-1.267113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6513970000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.267113em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.565em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=mclose >!</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.051892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.114892em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.428892em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class=mclose >!</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mopen >(</span><span class="mord text"><span class=mord >error</span></span><span class=mclose >)</span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo><mo>+</mo><msup><mi>f</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo><mo stretchy=false >(</mo><mi>x</mi><mo>−</mo><mi>a</mi><mo stretchy=false >)</mo><mo>+</mo><mfrac><mrow><msup><mi>f</mi><mrow><mo mathvariant=normal >′</mo><mo mathvariant=normal >′</mo></mrow></msup><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo></mrow><mrow><mn>2</mn><mo stretchy=false >!</mo></mrow></mfrac><mo stretchy=false >(</mo><mi>x</mi><mo>−</mo><mi>a</mi><msup><mo stretchy=false >)</mo><mn>2</mn></msup><mo>+</mo><mo>…</mo><mo stretchy=false >(</mo><mtext>error</mtext><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(x)=f(a)+f^{\prime}(a)(x-a)+\frac{f^{\prime \prime}(a)}{2 !}(x-a)^{2}+\ldots (\text{error})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.051892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.114892em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.428892em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class=mclose >!</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mopen >(</span><span class="mord text"><span class=mord >error</span></span><span class=mclose >)</span></span></span></span></span>
<p>Now instead of taking a step along the <em>real</em> axis for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span></span></span></span> small, we instead step along the complex axis, taking <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">ih</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">ih</span></span></span></span> small. That is, we evaluate:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo>+</mo><mi>i</mi><mi>h</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(x + ih)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ih</span><span class=mclose >)</span></span></span></span></span>
<p>Which gives us Taylor series:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo>+</mo><mi mathvariant=normal >i</mi><mi>h</mi><mo stretchy=false >)</mo><mo>=</mo><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>+</mo><mi mathvariant=normal >i</mi><mi>h</mi><msup><mi>f</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>−</mo><msup><mi>h</mi><mn>2</mn></msup><mfrac><mrow><msup><mi>f</mi><mrow><mo mathvariant=normal >′</mo><mo mathvariant=normal >′</mo></mrow></msup><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><mn>2</mn></mfrac><mo>+</mo><mtext>error</mtext></mrow><annotation encoding="application/x-tex">f(x+\mathrm{i} h)=f(x)+\mathrm{i} h f^{\prime}(x)-h^{2} \frac{f^{\prime \prime}(x)}{2}+ \text{error}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathrm">i</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord mathrm">i</span><span class="mord mathnormal">h</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.114892em;vertical-align:-0.686em;"></span><span class=mord ><span class="mord mathnormal">h</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.428892em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord text"><span class=mord >error</span></span></span></span></span></span>
<p>Where the error shrinks as we bring <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span></span></span></span> small. We can take the imaginary part of both sides to yield:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>I</mi><mi>m</mi><mo stretchy=false >(</mo><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo>+</mo><mi mathvariant=normal >i</mi><mi>h</mi><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo>=</mo><mi>I</mi><mi>m</mi><mrow><mo fence=true >(</mo><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>+</mo><mi mathvariant=normal >i</mi><mi>h</mi><msup><mi>f</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>−</mo><msup><mi>h</mi><mn>2</mn></msup><mfrac><mrow><msup><mi>f</mi><mrow><mo mathvariant=normal >′</mo><mo mathvariant=normal >′</mo></mrow></msup><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><mn>2</mn></mfrac><mo>+</mo><mtext>error</mtext><mo fence=true >)</mo></mrow></mrow><annotation encoding="application/x-tex">Im(f(x+\mathrm{i} h))=Im \left(f(x)+\mathrm{i} h f^{\prime}(x)-h^{2} \frac{f^{\prime \prime}(x)}{2}+ \text{error} \right)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">m</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathrm">i</span><span class="mord mathnormal">h</span><span class=mclose >))</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">m</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathrm">i</span><span class="mord mathnormal">h</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">h</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.428892em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord text"><span class=mord >error</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>I</mi><mi>m</mi><mo stretchy=false >(</mo><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo>+</mo><mi mathvariant=normal >i</mi><mi>h</mi><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo>=</mo><mi>h</mi><msup><mi>f</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>+</mo><mtext>error</mtext></mrow><annotation encoding="application/x-tex">Im(f(x+\mathrm{i} h))= h f^{\prime}(x) + \text{error} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">m</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathrm">i</span><span class="mord mathnormal">h</span><span class=mclose >))</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord text"><span class=mord >error</span></span></span></span></span></span>
<p>And then rearrange to solve for the derivative:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi>I</mi><mi>m</mi><mo stretchy=false >(</mo><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo>+</mo><mi mathvariant=normal >i</mi><mi>h</mi><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><mi>h</mi></mfrac><mo>+</mo><mtext>error</mtext><mo>=</mo><msup><mi>f</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\frac{Im(f(x+\mathrm{i} h))}{h} + \text{error}=f^{\prime}(x) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.113em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">h</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">m</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathrm">i</span><span class="mord mathnormal">h</span><span class=mclose >))</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord text"><span class=mord >error</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.051892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msup><mi>f</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mrow><mi>I</mi><mi>m</mi><mo stretchy=false >(</mo><mi>f</mi><mo stretchy=false >(</mo><mi>x</mi><mo>+</mo><mi mathvariant=normal >i</mi><mi>h</mi><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><mi>h</mi></mfrac><mo>+</mo><mtext>error</mtext></mrow><annotation encoding="application/x-tex">f^{\prime}(x) = \frac{Im(f(x+\mathrm{i} h))}{h} + \text{error} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.051892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.113em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">h</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">m</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathrm">i</span><span class="mord mathnormal">h</span><span class=mclose >))</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord text"><span class=mord >error</span></span></span></span></span></span>
<p>It&#39;s like magic&#33; We can use this to define a nicer formula for the derivative for use in our question:</p>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">Cstep</span>(<span class=hljs-params >f, x, h = <span class=hljs-number >0.001</span></span>) -&gt; <span class=hljs-built_in >float</span>:
    <span class=hljs-keyword >return</span> np.imag(f(x+ <span class=hljs-number >1j</span>*h))/h</code></pre>
<p>This numerical computation of the derivative is much more well behaved, for numerical analysis reasons &#40;subtracting two floating point numbers of similar sizes can destroy your accuracy, and it also converges faster&#41;. We plug this into our initial Newton&#39;s method function to get:</p>
<pre><code class="python hljs"><span class=hljs-keyword >def</span> <span class="hljs-title function_">Newton</span>(<span class=hljs-params >function, x0:<span class=hljs-built_in >float</span>, tol:<span class=hljs-built_in >float</span>, max_steps:<span class=hljs-built_in >int</span></span>) -&gt; <span class=hljs-built_in >float</span>:
    <span class=hljs-string >&quot;&quot;&quot;A simple Newton&#x27;s method solution to a function with an unknown derivative.&quot;&quot;&quot;</span>
    ratio = math.inf
    x = x0
    steps = <span class=hljs-number >0</span>

    <span class=hljs-keyword >while</span>(<span class=hljs-built_in >abs</span>(f(x)) &gt; tol):
        ratio  = function(x)/Cstep(f,x)
        x = x - ratio

        <span class=hljs-keyword >if</span> steps &gt; max_steps:
            <span class=hljs-keyword >break</span>

    <span class=hljs-keyword >return</span>(x)</code></pre>
<p>As a quick side note, the reason I don&#39;t type hint functions as inputs &#40;here&#41; is that I don&#39;t think type hinting objects as <code>callable</code> is helpful for the only purpose I&#39;m using type hints in these solutions –- easier to read functions.</p>
<hr />
<h3 id=problem_59 ><a href="#problem_59" class=header-anchor >Problem 59</a></h3>
<p>Assume that <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mi mathvariant=double-struck >R</mi></mrow><annotation encoding="application/x-tex">x \in \mathbb{R}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">R</span></span></span></span> represents an angle in radians. Reduce this angle to an angle in <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mn>0</mn><mo separator=true >,</mo><mn>2</mn><mi>π</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">[0,2 \pi)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class=mclose >)</span></span></span></span>.</p>
<pre><code class="python hljs"><span class=hljs-keyword >import</span> math

<span class=hljs-keyword >def</span> <span class="hljs-title function_">angle_reduce</span>(<span class=hljs-params >x: <span class=hljs-built_in >float</span></span>) -&gt; <span class=hljs-built_in >float</span>:
    <span class=hljs-keyword >return</span> x % (<span class=hljs-number >2</span>*math.pi)</code></pre>
<p>Question: the following code doesn&#39;t return the correct answer:</p>
<pre><code class="python hljs"><span class=hljs-keyword >import</span> math

<span class=hljs-keyword >def</span> <span class="hljs-title function_">angle_reduce</span>(<span class=hljs-params >x: <span class=hljs-built_in >float</span></span>) -&gt; <span class=hljs-built_in >float</span>:
    <span class=hljs-keyword >return</span> x % <span class=hljs-number >2</span>*math.pi</code></pre>
<p>Why?</p>
<div class=definition ><p><strong>Note</strong>: <em>Order of Operations</em></p>
<p>The function without the brackets evaluates left to right, calculating <code>&#40;x &#37; 2&#41;*math.pi</code>, which isn&#39;t what you want.</p></div>
<hr />
<h3 id=problem_60 ><a href="#problem_60" class=header-anchor >Problem 60</a></h3>
<p>Write a code for the function cos_series&#40;x&#41; which calculates an approximate value of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">cos(x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">cos</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span>, where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mi mathvariant=double-struck >R</mi></mrow><annotation encoding="application/x-tex">x \in \mathbb{R}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">R</span></span></span></span>, based on the partial sum &#40;of the Maclaurin series&#41; which consists of the first 25 terms. If <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> is not in <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mn>0</mn><mo separator=true >,</mo><mn>2</mn><mi>π</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">[0, 2π)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class=mclose >)</span></span></span></span>, reduce it to that interval.</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><munderover><mo>∑</mo><mn>0</mn><mn>1000</mn></munderover><mfrac><mrow><mo>−</mo><msup><mn>1</mn><mi>n</mi></msup></mrow><mrow><mn>2</mn><mi>n</mi><mo stretchy=false >!</mo></mrow></mfrac><msup><mi>x</mi><mrow><mn>2</mn><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">cos(x) = \sum_0^{1000} \frac{-1^n}{2n!} x^{2n}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">cos</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:3.068226em;vertical-align:-1.267113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8011130000000004em;"><span style="top:-1.882887em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1000</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.267113em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.341392em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class="mord mathnormal">n</span><span class=mclose >!</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >−</span><span class=mord ><span class=mord >1</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>Note that I am not going to reduce the angle in my solution, because I think it leads to a nicer graph, and I just solved that in the previous question.</p>
<pre><code class="python hljs"><span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np
<span class=hljs-keyword >import</span> matplotlib.pyplot <span class=hljs-keyword >as</span> plt

<span class=hljs-keyword >def</span> <span class="hljs-title function_">cos_series</span>(<span class=hljs-params >x:<span class=hljs-built_in >float</span></span>) -&gt;<span class=hljs-built_in >float</span>:
    out = <span class=hljs-number >0</span>
    <span class=hljs-keyword >for</span> n <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >0</span>,<span class=hljs-number >4</span>):
        out += (((-<span class=hljs-number >1</span>)**n)/(np.math.factorial(<span class=hljs-number >2</span>*n)))*x**(<span class=hljs-number >2</span>*n)
    <span class=hljs-keyword >return</span> out

x = np.linspace(<span class=hljs-number >0</span>,<span class=hljs-number >4</span>,<span class=hljs-number >2000</span>)
yVals = [cos_series(xi) <span class=hljs-keyword >for</span> xi <span class=hljs-keyword >in</span> x]
yTrue = [np.math.cos(xi) <span class=hljs-keyword >for</span> xi <span class=hljs-keyword >in</span> x]
plt.plot(x, yVals)
plt.plot(x, yTrue)</code></pre>
<p><img src="https://raw.githubusercontent.com/JasonPekos/Math1MP3/main/_assets/taylor.png" alt="taylor&#39;s version" /></p>
<hr />
<h3 id=problem_61 ><a href="#problem_61" class=header-anchor >Problem 61</a></h3>
<p>Write a code for the function cos_series&#40;x,tol&#61;1e-7,max terms&#61;15&#41; that calculates an approximate value of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">cos(x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">cos</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span>, where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mo stretchy=false >[</mo><mn>0</mn><mo separator=true >,</mo><mn>2</mn><mi>π</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">x \in [0, 2\pi)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class=mclose >)</span></span></span></span>. You will use a partial sum of the Maclaurin series for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">cos(x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">cos</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span></span></span></span>, and end it, depending on which of the following two events happens first: 15 terms are added, or the next term to be added is less than the tolerance tol.</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=false >(</mo><mi>x</mi><mo stretchy=false >)</mo><mo>=</mo><munderover><mo>∑</mo><mn>0</mn><mn>1000</mn></munderover><mfrac><mrow><mo>−</mo><msup><mn>1</mn><mi>n</mi></msup></mrow><mrow><mn>2</mn><mi>n</mi><mo stretchy=false >!</mo></mrow></mfrac><msup><mi>x</mi><mrow><mn>2</mn><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">cos(x) = \sum_0^{1000} \frac{-1^n}{2n!} x^{2n}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">cos</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:3.068226em;vertical-align:-1.267113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8011130000000004em;"><span style="top:-1.882887em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1000</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.267113em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.341392em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class="mord mathnormal">n</span><span class=mclose >!</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >−</span><span class=mord ><span class=mord >1</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span>
<pre><code class="python hljs"><span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np
<span class=hljs-keyword >import</span> matplotlib.pyplot <span class=hljs-keyword >as</span> plt

<span class=hljs-keyword >def</span> <span class="hljs-title function_">cos_series_2</span>(<span class=hljs-params >x: <span class=hljs-built_in >float</span>, tol = <span class=hljs-number >1e-7</span>, max_steps = <span class=hljs-number >15</span></span>):
    <span class=hljs-string >&quot;&quot;&quot;Cos taylor series approximation&quot;&quot;&quot;</span>
    out = <span class=hljs-number >0</span>
    n = <span class=hljs-number >0</span>
    <span class=hljs-keyword >while</span>(<span class=hljs-built_in >abs</span>(out-np.math.cos(x)) &gt; tol):
        out += (((-<span class=hljs-number >1</span>)**n)/(np.math.factorial(<span class=hljs-number >2</span>*n)))*x**(<span class=hljs-number >2</span>*n)
        n += <span class=hljs-number >1</span>
        <span class=hljs-keyword >if</span> n &gt;= max_steps:
            <span class=hljs-keyword >return</span> out
    <span class=hljs-keyword >return</span> out

x = np.linspace(<span class=hljs-number >0</span>,<span class=hljs-number >4</span>,<span class=hljs-number >2000</span>)
yVals = [cos_series_2(xi) <span class=hljs-keyword >for</span> xi <span class=hljs-keyword >in</span> x]
yVals3 = [cos_series_2(xi, max_steps = <span class=hljs-number >3</span>) <span class=hljs-keyword >for</span> xi <span class=hljs-keyword >in</span> x]
yTrue = [np.math.cos(xi) <span class=hljs-keyword >for</span> xi <span class=hljs-keyword >in</span> x]
plt.plot(x, yVals, <span class=hljs-string >&#x27;_&#x27;</span>)
plt.plot(x, yVals3, <span class=hljs-string >&#x27;-&#x27;</span>)
plt.plot(x, yTrue)</code></pre>
<p><img src="https://raw.githubusercontent.com/JasonPekos/Math1MP3/main/_assets/taylors_version_2.png" alt="taylor&#39;s version2" /></p>
<hr />
<div class=page-foot >
  <div class=copyright >
    &copy; JasonPekos. Last modified: April 08, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>